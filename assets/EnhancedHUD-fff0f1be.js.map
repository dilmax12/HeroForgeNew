{"version":3,"file":"EnhancedHUD-fff0f1be.js","sources":["../../src/services/replayService.ts","../../src/components/EnhancedHUD.tsx"],"sourcesContent":["import { supabase, supabaseConfigured } from '../lib/supabaseClient'\n\nexport async function getActiveWeeklyMutator(): Promise<{ id: string; name: string; modifiers: any } | null> {\n  try { localStorage.removeItem('replay_weekly_mutator') } catch {}\n  return null\n}\n\nexport async function getActiveGlobalEvents(): Promise<Array<{ id: string; name: string; modifiers: any }>> {\n  try { localStorage.removeItem('replay_global_events') } catch {}\n  return []\n}\n\nexport async function getPlayerRelics(): Promise<Array<{ id: string; name: string; effect: any }>> {\n  if (!supabaseConfigured) return []\n  const { data: u } = await supabase.auth.getUser()\n  const userId = u?.user?.id\n  if (!userId) return []\n  const { data, error } = await supabase\n    .from('player_relics')\n    .select('relic_id, relics(name,effect)')\n    .eq('user_id', userId)\n  if (error) return []\n  const rows = (data || []).map((r: any) => ({ id: r.relic_id, name: r.relics?.name, effect: r.relics?.effect }))\n  try { localStorage.setItem('replay_player_relics', JSON.stringify(rows)) } catch {}\n  return rows\n}\n\nexport async function claimDailyChest(): Promise<{ ok: boolean; error?: string; rewards?: any; streak?: number }>{\n  if (!supabaseConfigured) return { ok: false, error: 'Supabase desabilitado' }\n  const { data: u } = await supabase.auth.getUser()\n  const userId = u?.user?.id\n  if (!userId) return { ok: false, error: 'Usu√°rio n√£o autenticado' }\n  const now = new Date()\n  const base = { xp: 100, gold: 50, rare_item_chance: 0.1 }\n  const { data, error } = await supabase\n    .from('daily_chest_claims')\n    .insert({ user_id: userId, rewards: base })\n    .select('id,claimed_at,streak_count,rewards')\n    .single()\n  if (error) {\n    const msg = String(error.message || '')\n    if (msg.toLowerCase().includes('duplicate')) return { ok: false, error: 'Cofre di√°rio j√° coletado' }\n    return { ok: false, error: 'Falha ao coletar cofre' }\n  }\n  return { ok: true, rewards: data?.rewards || base, streak: data?.streak_count || 0 }\n}","import React, { useEffect, useRef, useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport { useHeroStore, calculateDerivedAttributes } from '../store/heroStore';\nimport { notificationBus } from './NotificationSystem';\nimport { Hero } from '../types/hero';\nimport { getOrRunDailyResult } from '../services/idleBattleService';\nimport { calculateXPForLevel, LEVEL_CAP } from '../utils/progression';\nimport { worldStateManager } from '../utils/worldState';\nimport { trackMetric } from '../utils/metricsSystem';\nimport { useMonetizationStore } from '../store/monetizationStore';\nimport { seasonalThemes, getRankIcon } from '../styles/medievalTheme';\nimport { getActiveWeeklyMutator, getActiveGlobalEvents, getPlayerRelics } from '../services/replayService';\n\ninterface EnhancedHUDProps {\n  hero: Hero;\n}\n\nconst EnhancedHUD: React.FC<EnhancedHUDProps> = ({ hero }) => {\n  const { activeSeasonalTheme } = useMonetizationStore();\n  const [daily, setDaily] = useState<any | null>(null);\n  const [submitting, setSubmitting] = useState(false);\n  const [leaderboard, setLeaderboard] = useState<any[]>([]);\n  const [weeklyMutator, setWeeklyMutator] = useState<string | null>(null);\n  const submitAbortRef = useRef<AbortController | null>(null);\n\n  const isMaxLevel = hero.progression.level >= LEVEL_CAP;\n  const currentLevelXP = calculateXPForLevel(hero.progression.level);\n  const nextLevelXP = isMaxLevel ? currentLevelXP : calculateXPForLevel(hero.progression.level + 1);\n  const xpProgressRaw = hero.progression.xp - currentLevelXP;\n  const xpProgress = Math.max(0, xpProgressRaw);\n  const xpNeeded = Math.max(1, nextLevelXP - currentLevelXP);\n  const xpPercentage = isMaxLevel ? 100 : Math.max(0, Math.min(100, (xpProgress / xpNeeded) * 100));\n  \n  // HP / Mana\n  const maxHp = hero.derivedAttributes.hp || 0;\n  const currentHp = hero.derivedAttributes.currentHp ?? maxHp;\n  const hpPercentage = Math.max(0, Math.min(100, (currentHp / maxHp) * 100));\n  \n  const maxMp = hero.derivedAttributes.mp || 0;\n  const currentMp = hero.derivedAttributes.currentMp ?? maxMp;\n  const mpPercentage = Math.max(0, Math.min(100, (currentMp / maxMp) * 100));\n\n  // UI: contadores e pulsos de recupera√ß√£o\n  const [nextHpMpSeconds, setNextHpMpSeconds] = useState<number | null>(null);\n  const [trainingSeconds, setTrainingSeconds] = useState<number | null>(null);\n  const [hpPulse, setHpPulse] = useState<number>(0);\n  const [mpPulse, setMpPulse] = useState<number>(0);\n\n  \n\n  const getXPColor = (progress: number) => {\n    if (progress >= 80) return 'bg-blue-500';\n    if (progress >= 50) return 'bg-blue-400';\n    return 'bg-blue-300';\n  };\n\n  const getHPColor = (percentage: number) => {\n    if (percentage >= 70) return 'bg-red-500';\n    if (percentage >= 30) return 'bg-red-400';\n    return 'bg-red-300';\n  };\n\n  const getMPColor = (percentage: number) => {\n    if (percentage >= 70) return 'bg-indigo-500';\n    if (percentage >= 30) return 'bg-indigo-400';\n    return 'bg-indigo-300';\n  };\n\n  useEffect(() => {\n    let mounted = true;\n    (async () => {\n      try {\n        const result = await getOrRunDailyResult(hero);\n        if (mounted) setDaily(result);\n      } catch (e) {\n        // silencioso no HUD\n      }\n      try {\n        const wm = await getActiveWeeklyMutator();\n        if (mounted) setWeeklyMutator(wm?.name || null);\n        await getActiveGlobalEvents();\n        await getPlayerRelics();\n      } catch {}\n    })();\n    return () => { mounted = false; };\n  }, [hero.id]);\n\n  // Pulsos: detectar aumentos em HP/MP e exibir +N por 2s\n  const prevHpRef = useRef<number>(currentHp);\n  const prevMpRef = useRef<number>(currentMp);\n  useEffect(() => {\n    const prevHp = prevHpRef.current ?? 0;\n    const prevMp = prevMpRef.current ?? 0;\n    const dhp = Math.max(0, (currentHp ?? 0) - (prevHp ?? 0));\n    const dmp = Math.max(0, (currentMp ?? 0) - (prevMp ?? 0));\n    if (dhp > 0) {\n      setHpPulse(dhp);\n      const t = setTimeout(() => setHpPulse(0), 2000);\n      return () => clearTimeout(t);\n    }\n    if (dmp > 0) {\n      setMpPulse(dmp);\n      const t = setTimeout(() => setMpPulse(0), 2000);\n      return () => clearTimeout(t);\n    }\n    prevHpRef.current = currentHp ?? 0;\n    prevMpRef.current = currentMp ?? 0;\n  }, [currentHp, currentMp]);\n\n  // Contagem regressiva local para pr√≥xima recupera√ß√£o (HP/Mana e Stamina)\n  const getSelectedHero = useHeroStore(s => s.getSelectedHero);\n  const setActiveMount = useHeroStore(s => s.setActiveMount);\n  const evolveMountForSelected = useHeroStore(s => s.evolveMountForSelected);\n  const refineCompanion = useHeroStore(s => s.refineCompanion);\n  \n  const trainMountForSelected = useHeroStore(s => s.trainMountForSelected);\n  React.useEffect(() => { const onKey = (e: KeyboardEvent) => { const favs = hero.favoriteMountIds || []; if (e.key === '1' && favs[0]) setActiveMount(favs[0]); if (e.key === '2' && favs[1]) setActiveMount(favs[1]); if (e.key === '3' && favs[2]) setActiveMount(favs[2]); }; window.addEventListener('keydown', onKey as any); return () => window.removeEventListener('keydown', onKey as any); }, [hero.favoriteMountIds])\n  const bestMountId = React.useMemo(() => {\n    const mounts = hero.mounts || [];\n    if (!mounts.length) return undefined as string | undefined;\n    if (hero.favoriteMountId && mounts.some(m => m.id === hero.favoriteMountId)) return hero.favoriteMountId as string;\n    const stageOrder: Record<string, number> = { comum: 0, encantada: 1, lendaria: 2 };\n    const rarityOrder: Record<string, number> = { comum: 0, incomum: 1, raro: 2, epico: 3, lendario: 4, mistico: 5 } as any;\n    const score = (m: any) => {\n      const attrSum = Object.values(m.attributes || {}).reduce((s: number, v: any) => s + (typeof v === 'number' ? v : 0), 0);\n      return (m.speedBonus || 0) * 3 + attrSum + (stageOrder[m.stage] || 0) * 2 + (rarityOrder[m.rarity] || 0);\n    };\n    return mounts.slice().sort((a,b) => score(b) - score(a))[0]?.id as string | undefined;\n  }, [hero.mounts, hero.favoriteMountId]);\n  useEffect(() => {\n    const interval = setInterval(() => {\n      const now = Date.now();\n      const latest = getSelectedHero() ?? hero;\n      // HP/Mana: baseado em lastActiveAt\n      const lastAct = latest.stats?.lastActiveAt ? new Date(latest.stats.lastActiveAt).getTime() : now;\n      const ttnHpMp = Math.max(0, 60000 - ((now - lastAct) % 60000));\n      setNextHpMpSeconds(Math.ceil(ttnHpMp / 1000));\n      \n      // Treino: baseado em stats.trainingActiveUntil\n      if (latest.stats?.trainingActiveUntil) {\n        const until = new Date(latest.stats.trainingActiveUntil).getTime();\n        const remainingMs = Math.max(0, until - now);\n        if (remainingMs > 0) {\n          setTrainingSeconds(Math.ceil(remainingMs / 1000));\n        } else {\n          setTrainingSeconds(null);\n        }\n      } else {\n        setTrainingSeconds(null);\n      }\n    }, 1000);\n    return () => clearInterval(interval);\n  }, [hero.id, getSelectedHero]);\n\n  const formatSecondsToMMSS = (seconds: number | null) => {\n    if (seconds === null) return '--:--';\n    const m = Math.floor(seconds / 60);\n    const s = seconds % 60;\n    return `${m}:${s.toString().padStart(2, '0')}`;\n  };\n\n  const submitDaily = async () => {\n    if (!hero || submitting) return;\n    const apiBase = (import.meta as any)?.env?.VITE_API_BASE;\n    if (!apiBase) return; // modo offline: n√£o chama API\n    setSubmitting(true);\n    try {\n      const payload = { hero };\n      if (submitAbortRef.current) { try { submitAbortRef.current.abort(); } catch {} }\n      submitAbortRef.current = new AbortController();\n      await fetch(`${apiBase}/daily-submit`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(payload),\n        signal: submitAbortRef.current.signal\n      });\n      const resLb = await fetch(`${apiBase}/daily-leaderboard`, { signal: submitAbortRef.current.signal });\n      const dataLb = await resLb.json();\n      setLeaderboard(Array.isArray(dataLb.entries) ? dataLb.entries.slice(0, 3) : []);\n      notificationBus.emit({\n        type: 'achievement',\n        title: 'Ranking Di√°rio',\n        message: 'Resultado enviado com sucesso! Confira o Top do dia.',\n        icon: 'üìÖ',\n        duration: 3500\n      });\n    } catch (err) {\n      // silencioso no HUD\n      notificationBus.emit({\n        type: 'quest',\n        title: 'Falha no envio',\n        message: 'N√£o foi poss√≠vel enviar seu resultado di√°rio.',\n        icon: '‚ö†Ô∏è',\n        duration: 4000\n      });\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  // Envio autom√°tico de resumo di√°rio\n  useEffect(() => {\n    (async () => {\n      if (!hero) return;\n      if (submitting) return;\n      const apiBase = (import.meta as any)?.env?.VITE_API_BASE;\n      if (!apiBase) return; // n√£o enviar em dev offline\n      await submitDaily();\n    })();\n    return () => { try { submitAbortRef.current?.abort(); } catch {} };\n  }, [hero?.id]);\n\n  const prevAchCount = useRef<number>(hero.progression.achievements.length);\n  useEffect(() => {\n    const current = hero.progression.achievements.length;\n    if (current > prevAchCount.current) {\n      const newly = hero.progression.achievements.slice(prevAchCount.current);\n      newly.forEach(a => {\n        notificationBus.emit({ type: 'quest', title: 'Conquista Desbloqueada', message: `${a.title}`, icon: 'üèÜ', duration: 3000 });\n      });\n      prevAchCount.current = current;\n    }\n  }, [hero.progression.achievements.length]);\n\n  const seasonalBorder = activeSeasonalTheme ? (seasonalThemes as any)[activeSeasonalTheme]?.border || 'border-gray-700' : 'border-gray-700';\n  const powerValue = typeof hero.derivedAttributes.power === 'number' \n    ? hero.derivedAttributes.power \n    : calculateDerivedAttributes(hero.attributes, hero.class, hero.progression.level, hero.inventory, hero.activeTitle).power;\n  const activePet = (hero.pets || []).find(p => p.id === hero.activePetId);\n  const costMap: Record<string, number> = { 'Instinto Feral': 8, 'Pulso Arcano': 10, 'Aura Sagrada': 9, 'Sussurro Sombrio': 12 };\n  const petSkillReady = activePet?.exclusiveSkill ? ((activePet.energy || 0) >= (costMap[activePet.exclusiveSkill] || 8)) : false;\n  const glowClass = petSkillReady ? 'shadow-2xl shadow-amber-500/20 border-amber-500/40' : seasonalBorder;\n  return (\n    <div className={`fixed top-2 right-2 md:top-4 md:right-4 z-50 bg-gray-900/95 backdrop-blur-sm border ${glowClass} rounded-lg p-2 md:p-4 min-w-56 sm:min-w-64 md:min-w-80 max-w-[90vw] shadow-xl`}>\n      {/* Hero Level and Name */}\n        <div className=\"flex items-center justify-between mb-2 md:mb-3\">\n          <div className=\"flex items-center space-x-4\">\n            <div className=\"relative\">\n              {hero.image ? (\n                <img src={hero.image} alt={hero.name} className=\"w-20 h-20 md:w-24 md:h-24 rounded-lg object-cover border border-amber-500/40 shadow-sm\" loading=\"lazy\" decoding=\"async\" />\n              ) : (\n                <div className=\"w-20 h-20 md:w-24 md:h-24 rounded-lg bg-gray-800 flex items_center justify-center text-2xl\">\n                  <span>{hero.avatar || 'üõ°Ô∏è'}</span>\n                </div>\n              )}\n              <div className=\"absolute bottom-0 left-1 inline-flex items-center gap-1 px-3 py-0 rounded-md bg-black/50 border border-amber-500/30 text-[10px] md:text-[11px]\">\n                <span className=\"text-white\">Nv. {hero.progression.level}</span>\n                <span className=\"text-yellow-300\">{getRankIcon(((hero as any)?.rankData?.currentRank) || 'F')} {((hero as any)?.rankData?.currentRank) || 'F'}</span>\n              </div>\n            </div>\n            <div>\n              <div className=\"flex items-center gap-2\">\n                <div className=\"text-white font-semibold text-sm md:text-base leading-tight truncate max-w-[40vw]\">{hero.name}</div>\n              </div>\n              <div className=\"text-gray-400 text-[10px] md:text-xs\">{hero.class}</div>\n            </div>\n          </div>\n          <div className=\"px-2 py-1 rounded-md bg-amber-500/20 text-amber-300 border border-amber-500/30 text-[10px] md:text-xs\">Poder {powerValue}</div>\n        </div>\n        {weeklyMutator && (\n          <div className=\"mb-2\">\n            <span className=\"inline-flex items-center px-2 py-1 rounded bg-purple-800/40 text-purple-200 border border-purple-600/40 text-[10px] md:text-xs\">Mutador semanal: {weeklyMutator}</span>\n          </div>\n        )}\n\n      \n\n      {/* Montaria Ativa */}\n      {(hero.mounts || []).find(m => m.id === hero.activeMountId) && (\n        <div className=\"mb-2 md:mb-3\">\n          <div className=\"flex justify-between items-center mb-1\">\n            <span className=\"text-amber-300 text-[11px] md:text-xs font-medium\">Montaria Ativa</span>\n            <span className=\"text-gray-300 text-[11px] md:text-xs\">Velocidade +{(hero.mounts || []).find(m => m.id === hero.activeMountId)?.speedBonus || 0}</span>\n          </div>\n            <div className=\"w-full bg-gray-800 rounded p-2\">\n              <div className=\"flex items-center justify-between\">\n                <div className=\"text-white text-xs md:text-sm font-medium\">{(hero.mounts || []).find(m => m.id === hero.activeMountId)?.name}</div>\n                <div className=\"text-xs\">\n                  {(() => {\n                    const m = (hero.mounts || []).find(mm => mm.id === hero.activeMountId);\n                    if (!m) return null;\n                    return (\n                      <span className=\"text-amber-300\">\n                        {m.stage}\n                        {typeof m.refineLevel === 'number' && m.refineLevel > 0 ? ` ‚Ä¢ +${m.refineLevel}` : ''}\n                        {typeof m.mastery === 'number' && m.mastery > 0 ? ` ‚Ä¢ Maestria ${m.mastery}` : ''}\n                        {(() => { const ms = Math.max(0, m.mastery||0); return ms>=30 ? ' ‚Ä¢ Mestre' : ms>=20 ? ' ‚Ä¢ Perito' : ms>=10 ? ' ‚Ä¢ Adepto' : '' })()}\n                      </span>\n                    );\n                  })()}\n                </div>\n              </div>\n              {(() => {\n                const red = worldStateManager.getMountStaminaReduction(hero);\n                if (!red) return null;\n                const pct = Math.round(red * 100);\n                return <div className=\"mt-1 text-[11px] text-emerald-300\">Redu√ß√£o de custo de fadiga por a√ß√£o: {pct}%</div>\n              })()}\n              <div className=\"mt-2 flex items-center gap-2\">\n                <button onClick={() => setActiveMount(undefined)} className=\"px-2 py-1 rounded bg-gray-700 hover:bg-gray-600 text-white text-[11px]\">Desativar</button>\n                {bestMountId && bestMountId !== hero.activeMountId && (\n                  <button onClick={() => setActiveMount(bestMountId)} className=\"px-2 py-1 rounded bg-indigo-600 hover:bg-indigo-700 text-white text-[11px]\">Ativar melhor</button>\n                )}\n              <button onClick={() => trainMountForSelected()} className=\"px-2 py-1 rounded bg-emerald-700 hover:bg-emerald-800 text-white text-[11px]\">Treinar</button>\n              {(() => {\n                const m = (hero.mounts || []).find(mm => mm.id === hero.activeMountId);\n                if (!m) return null;\n                const needsEssence = m.stage === 'encantada';\n                const hasScroll = (hero.inventory.items['pergaminho-montaria'] || 0) > 0;\n                const hasEssence = (hero.inventory.items['essencia-bestial'] || 0) > 0;\n                const enoughGold = (hero.progression.gold || 0) >= (m.stage === 'comum' ? 200 : 700);\n                const canEvolve = hasScroll && enoughGold && (!needsEssence || hasEssence);\n                const isMaxRefine = (m.refineLevel || 0) >= 10;\n                return (\n                  <>\n                    <button\n                      disabled={!canEvolve}\n                      title={canEvolve?`Consome üìú x1${needsEssence?' + üß¨ x1':''}`:''}\n                      onClick={() => {\n                        if (canEvolve) {\n                          const ok = window.confirm(`Evoluir ${m.name}? Custos: üìú x1${needsEssence?' + üß¨ x1':''} e ${(m.stage==='comum')?200:700} ouro.`);\n                          if (ok) evolveMountForSelected(m.id);\n                        }\n                      }}\n                      className={`px-2 py-1 rounded ${canEvolve?'bg-purple-600 hover:bg-purple-700':'bg-gray-700'} text-white text-[11px]`}\n                    >Evoluir</button>\n                    <button\n                      disabled={isMaxRefine || !((hero.inventory.items['pedra-magica']||0) > 0 || (hero.inventory.items['essencia-vinculo']||0) > 0)}\n                      title={isMaxRefine?'Refino m√°ximo atingido':''}\n                      onClick={() => {\n                        const ok = window.confirm(`Refinar ${m.name}? Consome 1 material e pode falhar.`);\n                        if (ok) refineCompanion(hero.id, 'mount', m.id);\n                      }}\n                      className={`px-2 py-1 rounded ${isMaxRefine?'bg-gray-700':'bg-violet-600 hover:bg-violet-700'} text-white text-[11px]`}\n                    >{isMaxRefine?'Refino M√°x.':'Refinar'}</button>\n                  </>\n                );\n              })()}\n            </div>\n            {(() => {\n              const mb = hero.mountBuff;\n              if (!mb?.speedBonus) return null;\n              const end = mb.expiresAt ? new Date(mb.expiresAt).getTime() : 0;\n              const rem = Math.max(0, end - Date.now());\n              const mins = Math.floor(rem / 60000);\n              const secs = Math.floor((rem % 60000) / 1000);\n              return <div className=\"mt-2 text-[11px] text-emerald-300\">Buff de velocidade +{mb.speedBonus} ‚Ä¢ expira em {String(mins).padStart(2,'0')}:{String(secs).padStart(2,'0')}</div>;\n            })()}\n            {(() => {\n              const active = (hero.mounts || []).find(mm => mm.id === hero.activeMountId)\n              const best = (hero.mounts || []).find(mm => mm.id === bestMountId)\n              if (!active || !best || active.id === best.id) return null\n              const baseInit = Math.max(0, (hero.derivedAttributes.initiative || 0) - (active.speedBonus || 0))\n              const nextInit = Math.max(0, baseInit + (best.speedBonus || 0))\n              return (\n                <div className=\"mt-2 text-[11px] text-amber-300\">\n                  Melhor op√ß√£o: {best.name} ‚Ä¢ Velocidade +{best.speedBonus} ‚Ä¢ Iniciativa se ativar: {nextInit}\n                </div>\n              )\n            })()}\n          </div>\n        </div>\n      )}\n\n      {/* XP Progress */}\n      <div className=\"mb-2 md:mb-3\">\n        <div className=\"flex justify-between items-center mb-1\">\n          <span className=\"text-blue-400 text-[11px] md:text-xs font-medium\">Experi√™ncia</span>\n          <span className=\"text-gray-300 text-[11px] md:text-xs\">\n            {isMaxLevel ? 'MAX' : `${xpProgress}/${xpNeeded} XP`}\n          </span>\n        </div>\n        <div className=\"w-full bg-gray-700 rounded-full h-1.5 md:h-2\">\n          <div \n            className={`h-1.5 md:h-2 rounded-full transition-all duration-300 ${getXPColor(xpPercentage)}`}\n            style={{ width: `${xpPercentage}%` }}\n          />\n        </div>\n        <div className=\"text-[11px] md:text-xs text-gray-400 mt-1\">\n          {isMaxLevel ? 'N√≠vel M√°ximo' : `${xpPercentage.toFixed(1)}% para o n√≠vel ${hero.progression.level + 1}`}\n        </div>\n      </div>\n\n      {/* Attribute Points Indicator */}\n      {typeof hero.attributePoints === 'number' && hero.attributePoints > 0 && (\n        <div className=\"mb-2 md:mb-3\">\n          <div className=\"flex justify-between items-center mb-1\">\n            <span className=\"text-amber-300 text-[11px] md:text-xs font-medium\">Pontos de Atributo</span>\n            <span className=\"text-gray-200 text-[11px] md:text-xs\">{hero.attributePoints}</span>\n          </div>\n          <div className=\"w-full bg-gray-700 rounded h-7 md:h-8 flex items-center justify-between px-2 md:px-3\">\n            <span className=\"text-[11px] md:text-xs text-gray-300\">Voc√™ tem pontos para gastar</span>\n            <Link\n              to=\"/progression#atributos\"\n              title=\"Gaste seus pontos de atributo\"\n              onClick={() => {\n                try { trackMetric.featureUsed(hero.id, 'hud-attribute-link'); } catch {}\n              }}\n              className=\"text-[11px] md:text-xs bg-amber-500 hover:bg-amber-600 text-white px-2 py-1 rounded animate-pulse\">\n              Gastar\n            </Link>\n          </div>\n        </div>\n      )}\n\n      \n      \n\n      \n\n      \n\n      {/* HP */}\n      <div className=\"mb-2\">\n        <div className=\"flex justify-between items-center mb-1\">\n          <span className=\"text-red-400 text-xs font-medium\">Vida</span>\n          <span className=\"text-gray-300 text-xs\">\n            {currentHp}/{maxHp}\n          </span>\n        </div>\n        <div className=\"w-full bg-gray-700 rounded-full h-2\">\n          <div \n            className={`h-2 rounded-full transition-all duration-300 ${getHPColor(hpPercentage)}`}\n            style={{ width: `${hpPercentage}%` }}\n          />\n        </div>\n        \n      </div>\n\n      {/* Mana */}\n      <div className=\"mb-2\">\n        <div className=\"flex justify-between items-center mb-1\">\n          <span className=\"text-indigo-400 text-xs font-medium\">Mana</span>\n          <span className=\"text-gray-300 text-xs\">\n            {currentMp}/{maxMp}\n          </span>\n        </div>\n        <div className=\"w-full bg-gray-700 rounded-full h-2\">\n          <div \n            className={`h-2 rounded-full transition-all duration-300 ${getMPColor(mpPercentage)}`}\n            style={{ width: `${mpPercentage}%` }}\n          />\n        </div>\n        \n      </div>\n\n      \n\n      {/* Treino Ativo */}\n      {trainingSeconds !== null && (\n        <div className=\"mb-3\">\n          <div className=\"flex justify-between items-center mb-1\">\n            <span className=\"text-yellow-300 text-xs font-medium\">Treino</span>\n            <span className=\"text-gray-300 text-[11px]\">\n              {hero.stats?.trainingActiveName || 'Em andamento'}\n            </span>\n          </div>\n          <div className=\"w-full bg-gray-700 rounded h-7 flex items-center justify-between px-2\">\n            <span className=\"text-[11px] text-gray-300\">Tempo restante</span>\n            <span className=\"text-[11px] text-yellow-300 font-medium\">{formatSecondsToMMSS(trainingSeconds)}</span>\n          </div>\n        </div>\n      )}\n\n      {/* Fadiga */}\n      {typeof hero.progression.fatigue === 'number' && (\n        <div className=\"mb-3\">\n          <div className=\"flex justify-between items-center mb-1\">\n            <span className=\"text-amber-300 text-xs font-medium\">Fadiga</span>\n            <span className=\"text-gray-300 text-xs\">{hero.progression.fatigue}/100</span>\n          </div>\n          {hero.progression.fatigue >= 50 ? (\n            <div className=\"text-xs text-amber-300 mt-1 flex items-center\">\n              üò¥ Fadiga alta ‚Äî descanse na taverna ou use um t√¥nico\n            </div>\n          ) : hero.progression.fatigue > 0 ? (\n            <div className=\"text-[10px] text-gray-400\">Em recupera√ß√£o passiva durante o tempo</div>\n          ) : null}\n        </div>\n      )}\n\n      \n\n      \n\n      \n\n      \n    </div>\n  );\n};\n\nexport default EnhancedHUD;\n"],"names":["getActiveWeeklyMutator","getActiveGlobalEvents","getPlayerRelics","supabaseConfigured","u","supabase","userId","_a","data","error","rows","r","_b","EnhancedHUD","hero","activeSeasonalTheme","useMonetizationStore","daily","setDaily","useState","submitting","setSubmitting","leaderboard","setLeaderboard","weeklyMutator","setWeeklyMutator","submitAbortRef","useRef","isMaxLevel","LEVEL_CAP","currentLevelXP","calculateXPForLevel","nextLevelXP","xpProgressRaw","xpProgress","xpNeeded","xpPercentage","maxHp","currentHp","hpPercentage","maxMp","currentMp","mpPercentage","nextHpMpSeconds","setNextHpMpSeconds","trainingSeconds","setTrainingSeconds","hpPulse","setHpPulse","mpPulse","setMpPulse","getXPColor","progress","getHPColor","percentage","getMPColor","useEffect","mounted","result","getOrRunDailyResult","wm","prevHpRef","prevMpRef","prevHp","prevMp","dhp","dmp","t","getSelectedHero","useHeroStore","s","setActiveMount","evolveMountForSelected","refineCompanion","trainMountForSelected","React","onKey","e","favs","bestMountId","mounts","m","stageOrder","rarityOrder","score","attrSum","v","a","b","interval","now","latest","lastAct","ttnHpMp","until","remainingMs","formatSecondsToMMSS","seconds","submitDaily","apiBase","payload","dataLb","notificationBus","prevAchCount","current","seasonalBorder","seasonalThemes","powerValue","calculateDerivedAttributes","activePet","p","costMap","glowClass","jsxs","jsx","getRankIcon","_c","_d","_e","mm","ms","red","worldStateManager","pct","needsEssence","hasScroll","hasEssence","enoughGold","canEvolve","isMaxRefine","Fragment","mb","end","rem","mins","secs","active","best","baseInit","nextInit","Link","trackMetric","_f"],"mappings":"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"}